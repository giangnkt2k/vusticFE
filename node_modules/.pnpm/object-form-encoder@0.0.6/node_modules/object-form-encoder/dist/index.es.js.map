{"version":3,"file":"index.es.js","sources":["../src/converter.ts","../src/normalizers/array.ts","../src/normalizers/boolean.ts","../src/normalizers/date.ts","../src/normalizers/file.ts","../src/normalizers/filelist.ts","../src/normalizers/object.ts","../src/normalizers/scalar.ts","../src/index.ts"],"sourcesContent":["import { Converter, Normalizer } from './types';\n\nexport default class ObjectConverter implements Converter {\n    private normalizers: Array<Normalizer>;\n\n    constructor(normalizers: Array<Normalizer>) {\n        this.normalizers = normalizers;\n    }\n\n    convertObjectToFormData(value: Record<string, any>): FormData {\n        let formData = new FormData();\n\n        for (const key in value) {\n            if (!value.hasOwnProperty(key) || value[key] === undefined) {\n                continue;\n            }\n\n            const fieldValue = value[key];\n\n            let isNormalized = false;\n\n            for (const normalizer of this.normalizers) {\n                if (!normalizer.shouldNormalize(fieldValue)) {\n                    continue;\n                }\n\n                formData = normalizer.normalize(formData, key, fieldValue);\n                isNormalized = true;\n\n                break;\n            }\n\n            if (!isNormalized) {\n                throw new Error(`No normalizer found for ${key}`);\n            }\n        }\n\n        return formData;\n    }\n}\n","import { Normalizer } from '../types';\n\nexport default class ArrayNormalizer implements Normalizer {\n    private readonly normalizers: Array<Normalizer>;\n\n    constructor(normalizers: Array<Normalizer>) {\n        this.normalizers = normalizers;\n    }\n\n    normalize(formData: FormData, key: string, value: object): FormData {\n        const arrayKey = `${key}[]`;\n\n        for (const item of value as any[]) {\n            formData = this.normalizeArrayItem(formData, arrayKey, item);\n        }\n\n        return formData;\n    }\n\n    normalizeArrayItem(formData: FormData, key: string, value: any): FormData {\n        for (const normalizer of this.normalizers) {\n            if (normalizer.shouldNormalize(value)) {\n                return normalizer.normalize(formData, key, value);\n            }\n        }\n\n        throw new Error(`No normalizer found for '${value}'`);\n    }\n\n    shouldNormalize(value: any): boolean {\n        return Array.isArray(value);\n    }\n}\n","import { Normalizer } from '../types';\n\nexport default class BooleanNormalizer implements Normalizer {\n    normalize(formData: FormData, key: string, value: any): FormData {\n        formData.append(key, (value as boolean) ? '1' : '0');\n\n        return formData;\n    }\n\n    shouldNormalize(value: any): boolean {\n        return typeof value === 'boolean';\n    }\n}\n","import { Normalizer } from '../types';\n\nexport default class DateNormalizer implements Normalizer {\n    normalize(formData: FormData, key: string, value: any): FormData {\n        formData.append(key, (value as Date).toISOString());\n\n        return formData;\n    }\n\n    shouldNormalize(value: any): boolean {\n        return value instanceof Date;\n    }\n}\n","import { Normalizer } from '../types';\n\nexport default class FileNormalizer implements Normalizer {\n    normalize(formData: FormData, key: string, value: any): FormData {\n        formData.append(key, value as File);\n\n        return formData;\n    }\n\n    shouldNormalize(value: any): boolean {\n        return value instanceof File;\n    }\n}\n","import { Normalizer } from '../types';\n\nexport default class FileListNormalizer implements Normalizer {\n    normalize(formData: FormData, key: string, value: any): FormData {\n        const arrayKey = `${key}[]`;\n\n        for (const file of value as FileList) {\n            formData.append(arrayKey, file);\n        }\n\n        return formData;\n    }\n\n    shouldNormalize(value: any): boolean {\n        return value instanceof FileList;\n    }\n}\n","import { Normalizer } from '../types';\n\nexport default class ObjectNormalizer implements Normalizer {\n    normalize(formData: FormData, key: string, value: any): FormData {\n        const jsonString = JSON.stringify(value);\n\n        formData.append(key, jsonString);\n\n        return formData;\n    }\n\n    shouldNormalize(value: any): boolean {\n        return typeof value === 'object';\n    }\n}\n","import { Normalizer } from '../types';\n\nexport default class ScalarNormalizer implements Normalizer {\n    normalize(formData: FormData, key: string, value: any): FormData {\n        formData.append(key, value as string);\n\n        return formData;\n    }\n\n    shouldNormalize(value: any): boolean {\n        return typeof value !== 'object';\n    }\n}\n","import ObjectConverter from './converter';\nimport ArrayNormalizer from './normalizers/array';\nimport BooleanNormalizer from './normalizers/boolean';\nimport DateNormalizer from './normalizers/date';\nimport FileNormalizer from './normalizers/file';\nimport FileListNormalizer from './normalizers/filelist';\nimport ObjectNormalizer from './normalizers/object';\nimport ScalarNormalizer from './normalizers/scalar';\nimport { Normalizer } from './types';\n\nconst normalizers: Array<Normalizer> = [\n    new FileListNormalizer(),\n    new ArrayNormalizer([\n        new FileListNormalizer(),\n        new FileNormalizer(),\n        new DateNormalizer(),\n        new BooleanNormalizer(),\n        new ObjectNormalizer(),\n        new ScalarNormalizer(),\n    ]),\n    new FileNormalizer(),\n    new DateNormalizer(),\n    new BooleanNormalizer(),\n    new ObjectNormalizer(),\n    new ScalarNormalizer(),\n];\n\nconst converter = new ObjectConverter(normalizers);\n\nexport function objectToFormData(value: object): FormData {\n    const formData = converter.convertObjectToFormData(value);\n\n    return formData;\n}\n"],"names":["ObjectConverter","normalizers","__publicField","value","formData","key","fieldValue","isNormalized","normalizer","ArrayNormalizer","arrayKey","item","BooleanNormalizer","DateNormalizer","FileNormalizer","FileListNormalizer","file","ObjectNormalizer","jsonString","ScalarNormalizer","converter","objectToFormData"],"mappings":"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"}