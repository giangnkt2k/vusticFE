{"version":3,"file":"index.umd.js","sources":["../src/converter.ts","../src/normalizers/array.ts","../src/normalizers/boolean.ts","../src/normalizers/date.ts","../src/normalizers/file.ts","../src/normalizers/filelist.ts","../src/normalizers/object.ts","../src/normalizers/scalar.ts","../src/index.ts"],"sourcesContent":["import { Converter, Normalizer } from './types';\n\nexport default class ObjectConverter implements Converter {\n    private normalizers: Array<Normalizer>;\n\n    constructor(normalizers: Array<Normalizer>) {\n        this.normalizers = normalizers;\n    }\n\n    convertObjectToFormData(value: Record<string, any>): FormData {\n        let formData = new FormData();\n\n        for (const key in value) {\n            if (!value.hasOwnProperty(key) || value[key] === undefined) {\n                continue;\n            }\n\n            const fieldValue = value[key];\n\n            let isNormalized = false;\n\n            for (const normalizer of this.normalizers) {\n                if (!normalizer.shouldNormalize(fieldValue)) {\n                    continue;\n                }\n\n                formData = normalizer.normalize(formData, key, fieldValue);\n                isNormalized = true;\n\n                break;\n            }\n\n            if (!isNormalized) {\n                throw new Error(`No normalizer found for ${key}`);\n            }\n        }\n\n        return formData;\n    }\n}\n","import { Normalizer } from '../types';\n\nexport default class ArrayNormalizer implements Normalizer {\n    private readonly normalizers: Array<Normalizer>;\n\n    constructor(normalizers: Array<Normalizer>) {\n        this.normalizers = normalizers;\n    }\n\n    normalize(formData: FormData, key: string, value: object): FormData {\n        const arrayKey = `${key}[]`;\n\n        for (const item of value as any[]) {\n            formData = this.normalizeArrayItem(formData, arrayKey, item);\n        }\n\n        return formData;\n    }\n\n    normalizeArrayItem(formData: FormData, key: string, value: any): FormData {\n        for (const normalizer of this.normalizers) {\n            if (normalizer.shouldNormalize(value)) {\n                return normalizer.normalize(formData, key, value);\n            }\n        }\n\n        throw new Error(`No normalizer found for '${value}'`);\n    }\n\n    shouldNormalize(value: any): boolean {\n        return Array.isArray(value);\n    }\n}\n","import { Normalizer } from '../types';\n\nexport default class BooleanNormalizer implements Normalizer {\n    normalize(formData: FormData, key: string, value: any): FormData {\n        formData.append(key, (value as boolean) ? '1' : '0');\n\n        return formData;\n    }\n\n    shouldNormalize(value: any): boolean {\n        return typeof value === 'boolean';\n    }\n}\n","import { Normalizer } from '../types';\n\nexport default class DateNormalizer implements Normalizer {\n    normalize(formData: FormData, key: string, value: any): FormData {\n        formData.append(key, (value as Date).toISOString());\n\n        return formData;\n    }\n\n    shouldNormalize(value: any): boolean {\n        return value instanceof Date;\n    }\n}\n","import { Normalizer } from '../types';\n\nexport default class FileNormalizer implements Normalizer {\n    normalize(formData: FormData, key: string, value: any): FormData {\n        formData.append(key, value as File);\n\n        return formData;\n    }\n\n    shouldNormalize(value: any): boolean {\n        return value instanceof File;\n    }\n}\n","import { Normalizer } from '../types';\n\nexport default class FileListNormalizer implements Normalizer {\n    normalize(formData: FormData, key: string, value: any): FormData {\n        const arrayKey = `${key}[]`;\n\n        for (const file of value as FileList) {\n            formData.append(arrayKey, file);\n        }\n\n        return formData;\n    }\n\n    shouldNormalize(value: any): boolean {\n        return value instanceof FileList;\n    }\n}\n","import { Normalizer } from '../types';\n\nexport default class ObjectNormalizer implements Normalizer {\n    normalize(formData: FormData, key: string, value: any): FormData {\n        const jsonString = JSON.stringify(value);\n\n        formData.append(key, jsonString);\n\n        return formData;\n    }\n\n    shouldNormalize(value: any): boolean {\n        return typeof value === 'object';\n    }\n}\n","import { Normalizer } from '../types';\n\nexport default class ScalarNormalizer implements Normalizer {\n    normalize(formData: FormData, key: string, value: any): FormData {\n        formData.append(key, value as string);\n\n        return formData;\n    }\n\n    shouldNormalize(value: any): boolean {\n        return typeof value !== 'object';\n    }\n}\n","import ObjectConverter from './converter';\nimport ArrayNormalizer from './normalizers/array';\nimport BooleanNormalizer from './normalizers/boolean';\nimport DateNormalizer from './normalizers/date';\nimport FileNormalizer from './normalizers/file';\nimport FileListNormalizer from './normalizers/filelist';\nimport ObjectNormalizer from './normalizers/object';\nimport ScalarNormalizer from './normalizers/scalar';\nimport { Normalizer } from './types';\n\nconst normalizers: Array<Normalizer> = [\n    new FileListNormalizer(),\n    new ArrayNormalizer([\n        new FileListNormalizer(),\n        new FileNormalizer(),\n        new DateNormalizer(),\n        new BooleanNormalizer(),\n        new ObjectNormalizer(),\n        new ScalarNormalizer(),\n    ]),\n    new FileNormalizer(),\n    new DateNormalizer(),\n    new BooleanNormalizer(),\n    new ObjectNormalizer(),\n    new ScalarNormalizer(),\n];\n\nconst converter = new ObjectConverter(normalizers);\n\nexport function objectToFormData(value: object): FormData {\n    const formData = converter.convertObjectToFormData(value);\n\n    return formData;\n}\n"],"names":["ObjectConverter","normalizers","__publicField","value","formData","key","fieldValue","isNormalized","normalizer","ArrayNormalizer","arrayKey","item","BooleanNormalizer","DateNormalizer","FileNormalizer","FileListNormalizer","file","ObjectNormalizer","jsonString","ScalarNormalizer","converter","objectToFormData"],"mappings":"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"}