import{ai as C,O as u}from"#entry";import{u as A}from"./B4rT1Usr.js";import{u as s}from"./CLWt_t3k.js";function P(){const f=C();let a=f.public.API_URL+"/api/contracts";const d=A(),n=u([]),o=u(!1),r=u(null);async function l(t){console.log("Fetching contracts with search keyword:",t),o.value=!0,r.value=null,t&&(a+=`?search=${t}`);try{const{data:e}=await s(a);n.value=e.value||[],a=f.public.API_URL+"/api/contracts"}catch(e){r.value=e}finally{o.value=!1}}async function m(t){try{const e=new FormData;t.pdf_file&&e.append("pdf_file",t.pdf_file),t.name&&e.append("name",t.name),t.contract_number&&e.append("contract_number",t.contract_number),t.date_signed&&e.append("date_signed",t.date_signed),t.customer_id&&e.append("customer_id",t.customer_id.toString()),t.date_desk&&e.append("date_desk",t.date_desk),t.contract_value&&e.append("contract_value",t.contract_value.toString()),t.deposit&&e.append("deposit",t.deposit.toString()),t.status!==void 0&&e.append("status",t.status.toString());const{data:c,error:i}=await s(a,{method:"POST",body:e});Array.isArray(n.value)&&n.value.push(c.value),console.log("Created contract:",c,i)}catch(e){r.value=e}}async function p(t,e){const{data:c}=await s(`${a}/${t}`,{method:"PUT",body:JSON.stringify(e),headers:{"Content-Type":"application/json",...d}});if(Array.isArray(n.value)){const i=n.value.findIndex(h=>h.id===t);i!==-1&&(n.value[i]=c.value)}}async function v(t){try{await s(`${a}/${t}`,{method:"DELETE",headers:{...d}}),Array.isArray(n.value)&&(n.value=n.value.filter(e=>e.id!==t)),console.log("Deleted contract:",t)}catch(e){r.value=e}}async function _(){}async function g(){}return{contracts:n,loading:o,error:r,createContract:m,updateContract:p,deleteContract:v,fetchContracts:l,importContractsCSV:_,exportContractsCSV:g}}export{P as u};
