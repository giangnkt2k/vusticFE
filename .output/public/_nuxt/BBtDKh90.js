import{O as L,f as I,a as t,Q as H,h as oe,a9 as ee,A as Z,B as ne,C as re,D as ue,Y as de,G as ce,I as G,K as k,o as v,j as i,w as c,q as $,$ as N,r as h,J as z,L as b,a0 as fe,Z as Y,M as U,N as P,S as te,s as X,v as J,e as D,x as pe,t as me,_ as ge,P as ve,d as be,a3 as ye,a2 as he,ah as xe,X as ze}from"#entry";import{_ as Be}from"./s4AJLiq2.js";import{_ as ke,a as Ve}from"./CQGZ0vk5.js";import{a as Te,b as we,c as Fe}from"./Dxt7HkM3.js";import{u as $e}from"./B3S2tx8K.js";import{o as qe,i as Ce,s as A,n as K}from"./ClkMs6Pj.js";import"./B4rT1Usr.js";import"./CLWt_t3k.js";import"./BwCEniEi.js";import"./BtEvuF_g.js";function Me(s){if(!s||s==="*")return;const V=s.split(",").map(T=>{const e=T.trim();return e.includes("/")&&e.endsWith("/*")&&e.split("/")[0]||e}).filter(T=>!T.startsWith("."));return V.length>0?V:void 0}function Ue(s){const{accept:V="*",reset:T=!1,multiple:e=!1,dropzone:n=!0,onUpdate:q}=s,o=L(),B=L(),y=I(()=>Me(t(V))),l=r=>{!r||r.length===0||(r instanceof FileList&&(r=Array.from(r)),r.length>1&&!e&&(r=[r[0]]),q(r))},w=L(!1),p=H({open:()=>{}});function u(){p.open()}return oe(()=>{const{isOverDropZone:r}=n?Te(B,{dataTypes:y.value,onDrop:l}):{isOverDropZone:L(!1)};ee(r,C=>{w.value=C});const{onChange:F,open:S}=we({accept:t(V),multiple:e,input:t(o),reset:T});p.open=S,F(C=>l(C))}),{isDragging:w,open:u,inputRef:o,dropzoneRef:B}}const Se={slots:{root:"relative flex flex-col",base:["w-full flex-1 bg-default border border-default flex flex-col gap-2 items-stretch justify-center rounded-lg focus-visible:outline-2","transition-[background]"],wrapper:"flex flex-col items-center justify-center text-center",icon:"shrink-0",avatar:"shrink-0",label:"font-medium text-default mt-2",description:"text-muted mt-1",actions:"flex flex-wrap gap-1.5 shrink-0 mt-4",files:"",file:"relative",fileLeadingAvatar:"shrink-0",fileWrapper:"flex flex-col min-w-0",fileName:"text-default truncate",fileSize:"text-muted truncate",fileTrailingButton:""},variants:{color:{primary:"",secondary:"",success:"",info:"",warning:"",error:"",neutral:""},variant:{area:{wrapper:"px-4 py-3",base:"p-4"},button:{}},size:{xs:{base:"text-xs",icon:"size-4",file:"text-xs px-2 py-1 gap-1",fileWrapper:"flex-row gap-1"},sm:{base:"text-xs",icon:"size-4",file:"text-xs px-2.5 py-1.5 gap-1.5",fileWrapper:"flex-row gap-1"},md:{base:"text-sm",icon:"size-5",file:"text-xs px-2.5 py-1.5 gap-1.5"},lg:{base:"text-sm",icon:"size-5",file:"text-sm px-3 py-2 gap-2",fileSize:"text-xs"},xl:{base:"text-base",icon:"size-6",file:"text-sm px-3 py-2 gap-2"}},layout:{list:{root:"gap-2 items-start",files:"flex flex-col w-full gap-2",file:"min-w-0 flex items-center border border-default rounded-md w-full",fileTrailingButton:"ms-auto"},grid:{fileWrapper:"hidden",fileLeadingAvatar:"size-full rounded-lg",fileTrailingButton:"absolute -top-1.5 -end-1.5 p-0 rounded-full border-2 border-bg"}},position:{inside:"",outside:""},dropzone:{true:"border-dashed data-[dragging=true]:bg-elevated/25"},interactive:{true:""},highlight:{true:""},multiple:{true:""},disabled:{true:"cursor-not-allowed opacity-75"}},compoundVariants:[{color:"primary",class:"focus-visible:outline-primary"},{color:"secondary",class:"focus-visible:outline-secondary"},{color:"success",class:"focus-visible:outline-success"},{color:"info",class:"focus-visible:outline-info"},{color:"warning",class:"focus-visible:outline-warning"},{color:"error",class:"focus-visible:outline-error"},{color:"primary",highlight:!0,class:"border-primary"},{color:"secondary",highlight:!0,class:"border-secondary"},{color:"success",highlight:!0,class:"border-success"},{color:"info",highlight:!0,class:"border-info"},{color:"warning",highlight:!0,class:"border-warning"},{color:"error",highlight:!0,class:"border-error"},{color:"neutral",class:"focus-visible:outline-inverted"},{color:"neutral",highlight:!0,class:"border-inverted"},{size:"xs",layout:"list",class:{fileTrailingButton:"-me-1"}},{size:"sm",layout:"list",class:{fileTrailingButton:"-me-1.5"}},{size:"md",layout:"list",class:{fileTrailingButton:"-me-1.5"}},{size:"lg",layout:"list",class:{fileTrailingButton:"-me-2"}},{size:"xl",layout:"list",class:{fileTrailingButton:"-me-2"}},{variant:"button",size:"xs",class:{base:"p-1"}},{variant:"button",size:"sm",class:{base:"p-1.5"}},{variant:"button",size:"md",class:{base:"p-1.5"}},{variant:"button",size:"lg",class:{base:"p-2"}},{variant:"button",size:"xl",class:{base:"p-2"}},{layout:"grid",multiple:!0,class:{files:"grid grid-cols-2 md:grid-cols-3 gap-4 w-full",file:"p-0 aspect-square"}},{layout:"grid",multiple:!1,class:{file:"absolute inset-0 p-0"}},{interactive:!0,disabled:!1,class:"hover:bg-elevated/25"}],defaultVariants:{color:"primary",variant:"area",size:"md"}},_e=["id","name","accept","multiple","required","disabled"],De=Object.assign({inheritAttrs:!1},{__name:"UFileUpload",props:Z({as:{type:null,required:!1},id:{type:String,required:!1},name:{type:String,required:!1},icon:{type:String,required:!1},label:{type:String,required:!1},description:{type:String,required:!1},color:{type:null,required:!1},variant:{type:null,required:!1},size:{type:null,required:!1},layout:{type:null,required:!1,default:"grid"},position:{type:null,required:!1,default:"outside"},highlight:{type:Boolean,required:!1},accept:{type:String,required:!1,default:"*"},multiple:{type:Boolean,required:!1,default:!1},reset:{type:Boolean,required:!1,default:!1},dropzone:{type:Boolean,required:!1,default:!0},interactive:{type:Boolean,required:!1,default:!0},required:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},fileIcon:{type:String,required:!1},fileDelete:{type:[Boolean,Object],required:!1},fileDeleteIcon:{type:String,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1}},{modelValue:{type:null},modelModifiers:{}}),emits:Z(["change"],["update:modelValue"]),setup(s,{expose:V,emit:T}){const e=s,n=T,q=ne(),o=re(s,"modelValue"),B=ue(),{t:y}=de(),[l,w]=Fe(),{isDragging:p,open:u,inputRef:r,dropzoneRef:F}=Ue({accept:e.accept,reset:e.reset,multiple:e.multiple,dropzone:e.dropzone,onUpdate:O}),{emitFormInput:S,emitFormChange:C,id:d,name:le,disabled:R,ariaAttrs:ae}=ce(e),M=I(()=>e.multiple?"area":e.variant),j=I(()=>e.variant==="button"&&!e.multiple?"grid":e.layout),E=I(()=>j.value==="grid"&&e.multiple?"inside":M.value==="button"?"outside":e.position),m=I(()=>G({extend:G(Se),...B.ui?.fileUpload||{}})({dropzone:e.dropzone,interactive:e.interactive,color:e.color,size:e.size,variant:M.value,layout:j.value,position:E.value,multiple:e.multiple,highlight:e.highlight,disabled:e.disabled}));function se(a){return URL.createObjectURL(a)}function ie(a){if(a===0)return"0B";const g=1024,f=["B","KB","MB","GB"],x=Math.floor(Math.log(a)/Math.log(g)),W=a/Math.pow(g,x);return`${x===0?W.toString():W.toFixed(0)}${f[x]}`}function O(a,g=!1){if(e.multiple)if(g)o.value=a;else{const x=o.value||[];o.value=[...x,...a||[]]}else o.value=a?.[0];const f=new Event("change",{target:{value:o.value}});n("change",f),C(),S()}function _(a){if(!o.value)return;if(!e.multiple||a===void 0){O([],!0),F.value?.focus();return}const g=[...o.value];g.splice(a,1),O(g,!0),F.value?.focus()}return ee(o,a=>{(!Array.isArray(a)||!a.length)&&r.value&&(r.value.value="")}),V({inputRef:r,dropzoneRef:F}),(a,g)=>(v(),k(N,null,[i(t(l),null,{default:c(()=>[o.value&&(!Array.isArray(o.value)||o.value.length)?(v(),k(N,{key:0},[h(a.$slots,"files-top",{files:o.value,open:t(u),removeFile:_}),z("div",{class:b(m.value.files({class:e.ui?.files}))},[h(a.$slots,"files",{files:o.value},()=>[(v(!0),k(N,null,fe(Array.isArray(o.value)?o.value:[o.value],(f,x)=>(v(),k("div",{key:f.name,class:b(m.value.file({class:e.ui?.file}))},[h(a.$slots,"file",{file:f,index:x},()=>[h(a.$slots,"file-leading",{file:f,index:x},()=>[i(Y,{src:se(f),icon:s.fileIcon||t(B).ui.icons.file,size:e.size,class:b(m.value.fileLeadingAvatar({class:e.ui?.fileLeadingAvatar}))},null,8,["src","icon","size","class"])]),z("div",{class:b(m.value.fileWrapper({class:e.ui?.fileWrapper}))},[z("span",{class:b(m.value.fileName({class:e.ui?.fileName}))},[h(a.$slots,"file-name",{file:f,index:x},()=>[U(P(f.name),1)])],2),z("span",{class:b(m.value.fileSize({class:e.ui?.fileSize}))},[h(a.$slots,"file-size",{file:f,index:x},()=>[U(P(ie(f.size)),1)])],2)],2),h(a.$slots,"file-trailing",{file:f,index:x},()=>[i(te,X({color:"neutral"},{ref_for:!0},{...j.value==="grid"?{variant:"solid",size:"xs"}:{variant:"link",size:s.size},...typeof s.fileDelete=="object"?s.fileDelete:void 0},{"aria-label":t(y)("fileUpload.removeFile",{filename:f.name}),"trailing-icon":s.fileDeleteIcon||t(B).ui.icons.close,class:m.value.fileTrailingButton({class:e.ui?.fileTrailingButton}),onClick:J(W=>_(x),["stop","prevent"])}),null,16,["aria-label","trailing-icon","class","onClick"])])])],2))),128))])],2),h(a.$slots,"files-bottom",{files:o.value,open:t(u),removeFile:_})],64)):$("",!0)]),_:3}),i(t(ve),{as:s.as,class:b(m.value.root({class:[e.ui?.root,e.class]}))},{default:c(()=>[h(a.$slots,"default",{open:t(u),removeFile:_},()=>[(v(),D(pe(M.value==="button"?"button":"div"),{ref_key:"dropzoneRef",ref:F,role:M.value==="button"?void 0:"button","data-dragging":t(p),class:b(m.value.base({class:e.ui?.base})),tabindex:s.interactive&&!t(R)?0:-1,onClick:g[0]||(g[0]=f=>s.interactive&&!t(R)&&t(u)()),onKeydown:g[1]||(g[1]=J(()=>{},["prevent"])),onKeyup:g[2]||(g[2]=me(f=>s.interactive&&!t(R)&&t(u)(),["enter","space"]))},{default:c(()=>[E.value==="inside"?(v(),D(t(w),{key:0})):$("",!0),E.value!=="inside"||(s.multiple?!o.value?.length:!o.value)?(v(),k("div",{key:1,class:b(m.value.wrapper({class:e.ui?.wrapper}))},[h(a.$slots,"leading",{},()=>[M.value==="button"?(v(),D(ge,{key:0,name:s.icon||t(B).ui.icons.upload,class:b(m.value.icon({class:e.ui?.icon}))},null,8,["name","class"])):(v(),D(Y,{key:1,icon:s.icon||t(B).ui.icons.upload,size:e.size,class:b(m.value.avatar({class:e.ui?.avatar}))},null,8,["icon","size","class"]))]),M.value!=="button"?(v(),k(N,{key:0},[s.label||q.label?(v(),k("div",{key:0,class:b(m.value.label({class:e.ui?.label}))},[h(a.$slots,"label",{},()=>[U(P(s.label),1)])],2)):$("",!0),s.description||q.description?(v(),k("div",{key:1,class:b(m.value.description({class:e.ui?.description}))},[h(a.$slots,"description",{},()=>[U(P(s.description),1)])],2)):$("",!0),q.actions?(v(),k("div",{key:2,class:b(m.value.actions({class:e.ui?.actions}))},[h(a.$slots,"actions",{files:o.value,open:t(u),removeFile:_})],2)):$("",!0)],64)):$("",!0)],2)):$("",!0)]),_:3},40,["role","data-dragging","class","tabindex"])),E.value==="outside"?(v(),D(t(w),{key:0})):$("",!0)]),z("input",X({id:t(d),ref_key:"inputRef",ref:r,type:"file",name:t(le),accept:s.accept,multiple:s.multiple,required:s.required,disabled:t(R)},{...a.$attrs,...t(ae)},{class:"sr-only",tabindex:"-1"}),null,16,_e)]),_:3},8,["as","class"])],64))}}),Ae={class:"flex justify-between"},Ie={style:{"place-self":"center"}},Re={class:"flex items-center gap-4"},Ee={class:"flex items-center gap-4"},Q=2*1024*1024,Je=be({__name:"create",setup(s){const V=["application/pdf"],T=(y,l=2)=>{const p=l<0?0:l,u=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],r=Math.floor(Math.log(y)/Math.log(1024));return Number.parseFloat((y/Math.pow(1024,r)).toFixed(p))+" "+u[r]},e=qe({name:A().min(2,"Must be at least 2 characters"),contract_number:A().min(2,"Must be at least 2 characters"),date_desk:A(),date_signed:A(),customer_id:K().min(1,"Must select a customer"),contract_value:K().min(0,"Must be a positive number"),deposit:K().min(0,"Must be a positive number"),status:A().min(0,"Must be at least 2 characters"),pdf_file:Ce(File,{message:"Please select a pdf file."}).refine(y=>y.size<=Q,{message:`The pdf file is too large. Please choose a pdf file smaller than ${T(Q)}.`}).refine(y=>V.includes(y.type),{message:"Please upload a valid pdf file (application/pdf)."})}),n=H({name:"giang",contract_number:"12",date_desk:"2025-09-13",date_signed:"2025-09-12",customer_id:1,contract_value:1e6,deposit:1e5,status:"1",pdf_file:void 0}),q=ye(),{createContract:o}=$e();async function B(y){await o(y.data),q.add({title:"Success",description:"The form has been submitted.",color:"success"}),ze("/contracts")}return(y,l)=>{const w=te,p=Be,u=Ve,r=De,F=ke,S=xe,C=he;return v(),k("div",null,[i(C,{variant:"subtle"},{header:c(()=>[z("div",Ae,[l[10]||(l[10]=z("h2",{class:"text-lg font-medium"}," Create Contract ",-1)),i(w,{to:"/contracts"},{default:c(()=>[...l[9]||(l[9]=[U(" Back to Contracts ",-1)])]),_:1})])]),default:c(()=>[z("div",Ie,[i(S,null,{default:c(()=>[i(F,{schema:t(e),state:t(n),class:"space-y-4 flex flex-col gap-2",onSubmit:B},{default:c(()=>[z("div",Re,[i(u,{label:"Tên hợp đồng",name:"name"},{default:c(()=>[i(p,{modelValue:t(n).name,"onUpdate:modelValue":l[0]||(l[0]=d=>t(n).name=d),placeholder:"Enter contract name"},null,8,["modelValue"])]),_:1}),i(u,{label:"Số hợp đồng",name:"contract_number"},{default:c(()=>[i(p,{modelValue:t(n).contract_number,"onUpdate:modelValue":l[1]||(l[1]=d=>t(n).contract_number=d),placeholder:"Enter contract number"},null,8,["modelValue"])]),_:1}),i(u,{label:"Ngày ký",name:"date_signed"},{default:c(()=>[i(p,{modelValue:t(n).date_signed,"onUpdate:modelValue":l[2]||(l[2]=d=>t(n).date_signed=d),type:"date"},null,8,["modelValue"])]),_:1}),i(u,{label:"Ngày bàn giao",name:"date_desk"},{default:c(()=>[i(p,{modelValue:t(n).date_desk,"onUpdate:modelValue":l[3]||(l[3]=d=>t(n).date_desk=d),type:"date"},null,8,["modelValue"])]),_:1})]),z("div",Ee,[i(u,{label:"Customer ID",name:"customer_id"},{default:c(()=>[i(p,{modelValue:t(n).customer_id,"onUpdate:modelValue":l[4]||(l[4]=d=>t(n).customer_id=d),placeholder:"Customer ID",type:"number"},null,8,["modelValue"])]),_:1}),i(u,{label:"Giá trị hợp đồng",name:"contract_value"},{default:c(()=>[i(p,{modelValue:t(n).contract_value,"onUpdate:modelValue":l[5]||(l[5]=d=>t(n).contract_value=d),type:"number"},null,8,["modelValue"])]),_:1}),i(u,{label:"Tiền đã thu",name:"deposit"},{default:c(()=>[i(p,{modelValue:t(n).deposit,"onUpdate:modelValue":l[6]||(l[6]=d=>t(n).deposit=d),type:"number"},null,8,["modelValue"])]),_:1})]),i(u,{label:"Trạng thái",name:"status"},{default:c(()=>[i(p,{modelValue:t(n).status,"onUpdate:modelValue":l[7]||(l[7]=d=>t(n).status=d),placeholder:"Trạng thái"},null,8,["modelValue"])]),_:1}),i(u,{name:"pdf_file",label:"File hợp đồng (PDF)",description:"PDF. 2MB Max."},{default:c(()=>[i(r,{modelValue:t(n).pdf_file,"onUpdate:modelValue":l[8]||(l[8]=d=>t(n).pdf_file=d),class:"w-96 min-h-48"},null,8,["modelValue"])]),_:1}),i(w,{icon:"i-lucide-rocket",size:"md",type:"submit",class:"text-center w-2xl"},{default:c(()=>[...l[11]||(l[11]=[U(" Create Contract ",-1)])]),_:1})]),_:1},8,["schema","state"])]),_:1})])]),footer:c(()=>[...l[12]||(l[12]=[z("h1",null,"Create Contract",-1)])]),_:1})])}}});export{Je as default};
